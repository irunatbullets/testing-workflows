name: Discord
run-name: "Discord #${{ github.run_number }}"

permissions:
  contents: write

on:
  push:
    branches: [main]

concurrency:
  group: ${{ github.workflow }}-${{ github.ref }}
  cancel-in-progress: true

jobs:
  discord-message:
      name: Discord Message
      runs-on: ubuntu-latest
      if: github.repository_owner == 'irunatbullets'
      steps:
        - name: Send Discord message
          uses: hugoalh/send-discord-webhook-ghaction@v7.0.5
          with:
            key: "${{secrets.DISCORD_WEBHOOK}}"
            username: "irunatbullets"
            avatar_url: "https://cdn.modrinth.com/data/PoHFfv3G/53d3a9085947f25804334a2c5de8f656f3bb2f20.png"
            content_links_no_embed: .+
            embeds: |
              [
                {
                  "author": {
                    "name": "irunatbullets",
                    "icon_url": "https://cdn.modrinth.com/data/PoHFfv3G/53d3a9085947f25804334a2c5de8f656f3bb2f20.png"
                  },
                  "title": "Surface Living — New Release",
                  "url": "https://modrinth.com/modpack/surface-living/versions",
                  "color": 5763719,
                  "description": "A fresh update to **Surface Living** is out.\n\nThis release focuses on stability and small refinements while keeping the pack's original feel intact.",
                  "fields": [
                    {
                      "name": "Pack Version",
                      "value": "1.0.0",
                      "inline": true
                    },
                    {
                      "name": "Loader",
                      "value": "NeoForge",
                      "inline": true
                    },
                    {
                      "name": "Minecraft",
                      "value": "1.21.1",
                      "inline": true
                    },
                    {
                      "name": "Changelog",
                      "value": "• Something improved\n• Something else adjusted"
                    },
                    {
                      "name": "Links",
                      "value": "→ [View this release on Modrinth](https://modrinth.com/modpack/surface-living/versions)\n→ [Issue tracker & feedback](https://github.com/irunatbullets/surface-living/issues)\n→ [Optional support](https://ko-fi.com/irunatbullets)"
                    }
                  ]
                }
              ]
