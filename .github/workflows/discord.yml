name: Discord
run-name: "Discord #${{ github.run_number }}"

permissions:
  contents: write

on:
  push:
    branches: [main]

concurrency:
  group: ${{ github.workflow }}-${{ github.ref }}
  cancel-in-progress: true

jobs:
  discord-message:
      name: Discord Message
      runs-on: ubuntu-latest
      if: github.repository_owner == 'irunatbullets'
      steps:
        - name: Send Discord message
          uses: hugoalh/send-discord-webhook-ghaction@v7.0.5
          with:
            key: "${{secrets.DISCORD_WEBHOOK}}"
            username: "irunatbullets"
            avatar_url: "https://cdn.modrinth.com/data/PoHFfv3G/53d3a9085947f25804334a2c5de8f656f3bb2f20.png"
            content_links_no_embed: .+
            content: |
              test
            embeds: |
              [
                {
                  "author": {
                    "name": "irunatbullets",
                    "icon_url": "https://cdn.modrinth.com/data/PoHFfv3G/53d3a9085947f25804334a2c5de8f656f3bb2f20.png"
                  },
                  "title": "New version of Surface Living released!",
                  "url": "https://modrinth.com/modpack/surface-living/versions",
                  "color": "#57F287",
                  "description": "## Wow\nDoes this work? ```who knows```",
                  "fields": [
                    {
                      "name": "Pack version",
                      "value": "1.0.0",
                      "inline": true
                    },
                    {
                      "name": "Loader",
                      "value": "neoforge",
                      "inline": true
                    },
                    {
                      "name": "Mincecraft version",
                      "value": "1.21.1",
                      "inline": true
                    },
                    {
                      "name": "Changlog",
                      "value": "- something\n- something else"
                    },
                  ],
                  "thumbnail": {
                    "url": "https://upload.wikimedia.org/wikipedia/commons/3/38/4-Nature-Wallpapers-2014-1_ukaavUI.jpg"
                  },
                  "image": {
                    "url": "https://upload.wikimedia.org/wikipedia/commons/5/5a/A_picture_from_China_every_day_108.jpg"
                  }
                }
              ]